import{c as b,r as m,w as _,o as z,h as v,T as H,b as I,U as w,Z as Q,S as k,g as $,O as q}from"./index.cd412eb4.js";import{h as F}from"./QBtn.27037d6f.js";import{c as R,h as V}from"./render.390dd149.js";import{q as A,z as U,A as W}from"./format.7223076b.js";const Z={ratio:[String,Number]};function G(e,f){return b(()=>{const t=Number(e.ratio||(f!==void 0?f.value:void 0));return isNaN(t)!==!0&&t>0?{paddingBottom:`${100/t}%`}:null})}const J=16/9;var ne=R({name:"QImg",props:{...Z,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:J},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:f,emit:t}){const l=m(e.initialRatio),a=G(e,l);let o=null,s=!1;const u=[m(null),m(C())],n=m(0),r=m(!1),c=m(!1),g=b(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),h=b(()=>({width:e.width,height:e.height})),d=b(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),S=b(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));_(()=>O(),x);function O(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function C(){return e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null}function x(i){o!==null&&(clearTimeout(o),o=null),c.value=!1,i===null?(r.value=!1,u[n.value^1].value=C()):r.value=!0,u[n.value].value=i}function B({target:i}){s!==!0&&(o!==null&&(clearTimeout(o),o=null),l.value=i.naturalHeight===0?.5:i.naturalWidth/i.naturalHeight,E(i,1))}function E(i,y){s===!0||y===1e3||(i.complete===!0?M(i):o=setTimeout(()=>{o=null,E(i,y+1)},50))}function M(i){s!==!0&&(n.value=n.value^1,u[n.value].value=null,r.value=!1,c.value=!1,t("load",i.currentSrc||i.src))}function p(i){o!==null&&(clearTimeout(o),o=null),r.value=!1,c.value=!0,u[n.value].value=null,u[n.value^1].value=C(),t("error",i)}function N(i){const y=u[i].value,T={key:"img_"+i,class:d.value,style:S.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...y};return n.value===i?(T.class+=" q-img__image--waiting",Object.assign(T,{onLoad:B,onError:p})):T.class+=" q-img__image--loaded",v("div",{class:"q-img__container absolute-full",key:"img"+i},v("img",T))}function D(){return r.value!==!0?v("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},V(f[c.value===!0?"error":"default"])):v("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},f.loading!==void 0?f.loading():e.noSpinner===!0?void 0:[v(F,{color:e.spinnerColor,size:e.spinnerSize})])}return x(O()),z(()=>{s=!0,o!==null&&(clearTimeout(o),o=null)}),()=>{const i=[];return a.value!==null&&i.push(v("div",{key:"filler",style:a.value})),c.value!==!0&&(u[0].value!==null&&i.push(N(0)),u[1].value!==null&&i.push(N(1))),i.push(v(H,{name:"q-transition--fade"},D)),v("div",{class:g.value,style:h.value,role:"img","aria-label":e.alt},i)}}});function K(){const e=m(!I.value);return e.value===!1&&w(()=>{e.value=!0}),e}const j=typeof ResizeObserver!="undefined",L=j===!0?{}:{style:"display:block;position:absolute;top:0;left:0;right:0;bottom:0;height:100%;width:100%;overflow:hidden;pointer-events:none;z-index:-1;",url:"about:blank"};var le=R({name:"QResizeObserver",props:{debounce:{type:[String,Number],default:100}},emits:["resize"],setup(e,{emit:f}){let t=null,l,a={width:-1,height:-1};function o(n){n===!0||e.debounce===0||e.debounce==="0"?s():t===null&&(t=setTimeout(s,e.debounce))}function s(){if(t!==null&&(clearTimeout(t),t=null),l){const{offsetWidth:n,offsetHeight:r}=l;(n!==a.width||r!==a.height)&&(a={width:n,height:r},f("resize",a))}}const{proxy:u}=$();if(j===!0){let n;const r=c=>{l=u.$el.parentNode,l?(n=new ResizeObserver(o),n.observe(l),s()):c!==!0&&k(()=>{r(!0)})};return w(()=>{r()}),z(()=>{t!==null&&clearTimeout(t),n!==void 0&&(n.disconnect!==void 0?n.disconnect():l&&n.unobserve(l))}),Q}else{let c=function(){t!==null&&(clearTimeout(t),t=null),r!==void 0&&(r.removeEventListener!==void 0&&r.removeEventListener("resize",o,q.passive),r=void 0)},g=function(){c(),l&&l.contentDocument&&(r=l.contentDocument.defaultView,r.addEventListener("resize",o,q.passive),s())};const n=K();let r;return w(()=>{k(()=>{l=u.$el,l&&g()})}),z(c),u.trigger=o,()=>{if(n.value===!0)return v("object",{style:L.style,tabindex:-1,type:"text/html",data:L.url,"aria-hidden":"true",onLoad:g})}}}});const{passive:P}=q,X=["both","horizontal","vertical"];var re=R({name:"QScrollObserver",props:{axis:{type:String,validator:e=>X.includes(e),default:"vertical"},debounce:[String,Number],scrollTarget:{default:void 0}},emits:["scroll"],setup(e,{emit:f}){const t={position:{top:0,left:0},direction:"down",directionChanged:!1,delta:{top:0,left:0},inflectionPoint:{top:0,left:0}};let l=null,a,o;_(()=>e.scrollTarget,()=>{n(),u()});function s(){l!==null&&l();const g=Math.max(0,U(a)),h=W(a),d={top:g-t.position.top,left:h-t.position.left};if(e.axis==="vertical"&&d.top===0||e.axis==="horizontal"&&d.left===0)return;const S=Math.abs(d.top)>=Math.abs(d.left)?d.top<0?"up":"down":d.left<0?"left":"right";t.position={top:g,left:h},t.directionChanged=t.direction!==S,t.delta=d,t.directionChanged===!0&&(t.direction=S,t.inflectionPoint=t.position),f("scroll",{...t})}function u(){a=A(o,e.scrollTarget),a.addEventListener("scroll",r,P),r(!0)}function n(){a!==void 0&&(a.removeEventListener("scroll",r,P),a=void 0)}function r(g){if(g===!0||e.debounce===0||e.debounce==="0")s();else if(l===null){const[h,d]=e.debounce?[setTimeout(s,e.debounce),clearTimeout]:[requestAnimationFrame(s),cancelAnimationFrame];l=()=>{d(h),l=null}}}const{proxy:c}=$();return _(()=>c.$q.lang.rtl,s),w(()=>{o=c.$el.parentNode,u()}),z(()=>{l!==null&&l(),n()}),Object.assign(c,{trigger:r,getPosition:()=>t}),Q}});export{le as Q,re as a,ne as b};
